<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>å¥å­æœç´¢å™¨ï¼ˆSupabaseç‰ˆï¼‰</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;padding:20px;background:#f7f9fc;}
  .wrap{max-width:800px;margin:0 auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);}
  h1{font-size:22px;margin-bottom:16px;}
  input{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:16px;}
  .result{margin-top:20px;}
  .sentence{padding:10px 0;border-bottom:1px solid #eee;}
  .highlight{background:yellow;font-weight:bold;}
  .none{color:#777;margin-top:10px;}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ” å¥å­æœç´¢ï¼ˆå®æ—¶æ¥è‡ª Supabaseï¼‰</h1>
  <input id="searchInput" type="text" placeholder="è¾“å…¥å…³é”®è¯..." />
  <div id="result" class="result">åŠ è½½ä¸­â€¦</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script>
  // âœ… Supabase è¿æ¥é…ç½®ï¼ˆä½¿ç”¨ä½ çš„é¡¹ç›®ï¼‰
  const SUPABASE_URL = "https://jozhcjtuoveuavxmibjo.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpvemhjanR1b3ZldWF2eGxqa21pYmpvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMzAxODMsImV4cCI6MjA3NzgwNjE4M30.AUEyXqe8mm4PVHpLYzpWZ98BMT4kUbKNNS2U2QHMSAs";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  const input = document.getElementById('searchInput');
  const resultDiv = document.getElementById('result');
  let sentences = [];

  // âœ… è¯»å–å¥å­
  async function loadSentences() {
    resultDiv.textContent = 'æ­£åœ¨åŠ è½½å¥å­...';
    const { data, error } = await supabase
      .from('sentences')
      .select('*')
      .order('id', { ascending: true });

    if (error) {
      console.error(error);
      resultDiv.textContent = 'åŠ è½½å¤±è´¥ï¼š' + error.message;
      return;
    }

    sentences = data.map(r => r.content);
    resultDiv.textContent = 'å·²åŠ è½½ ' + sentences.length + ' æ¡å¥å­ã€‚';
  }

  // âœ… æœç´¢å¹¶æ˜¾ç¤º
  function renderResults(keyword) {
    resultDiv.innerHTML = '';
    if (!keyword.trim()) return;
    const filtered = sentences.filter(s => s.includes(keyword));
    if (filtered.length === 0) {
      resultDiv.innerHTML = '<p class="none">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¥å­ã€‚</p>';
      return;
    }
    filtered.forEach(s => {
      const highlighted = s.replaceAll(keyword, `<span class="highlight">${keyword}</span>`);
      const div = document.createElement('div');
      div.className = 'sentence';
      div.innerHTML = highlighted;
      resultDiv.appendChild(div);
    });
  }

  input.addEventListener('input', e => {
    renderResults(e.target.value);
  });

  loadSentences();
</script>
</body>
</html>
